{% extends "admin/base_site.html" %}
{% load p3 assopy_tags conference %}
{% block breadcrumbs %}
<div class="breadcrumbs">
     <a href="../../../">Home</a> &rsaquo;
     <a href="../../../">Conference</a> &rsaquo;
     <a href="../../">Tickets</a>&rsaquo;
     <a href="../">stats</a>&rsaquo;
     details
</div>
{% endblock %}{% block content %}
<h1>{{ stat.short_description }} (<a href="">csv</a>)</h1>
{% with stat.get_data as result %}
<table>
    <tr>
        {% for colid, colname in result.columns %}
        <th>{{ colname }}</th>
        {% endfor %}
    </tr>
    {% paginate result.data count=50 as page %}
    {% for row in page.object_list %}
    <tr>
        {% for colid, colname in result.columns %}
        <td>{{ row|attrib_:colid }}</td>
        {% endfor %}
    </tr>
    {% endfor %}
</table>
<div class="pagination">
    <span class="step-links">
        {% if page.has_previous %}
            <a href="?{% add_page_number_to_query page.previous_page_number %}">previous</a>
        {% endif %}

        <span class="current">
            Page {{ page.number }} of {{ page.paginator.num_pages }}.
        </span>

        {% if page.has_next %}
            <a href="?{% add_page_number_to_query page.next_page_number %}">next</a>
        {% endif %}
    </span>
</div>
{% endwith %}

{% if request.user.email %}
<hr />
<h1>Invia un email a tutti i partecipanti di questa lista</h1>
<form action="" method="POST">{% csrf_token %}
    <table>
        {{ form.as_table }}
    </table>
    <input type="submit" value="invia" />
</form>
<pre>
{% templatetag openblock %} load p3 %}           => load p3 template tag library
{% templatetag openvariable %} user }}              => assopy user instance
{% templatetag openvariable %} user.name }}         => full name (eg. Giovanni Bajo)
{% templatetag openvariable %} user|tickets_url }}  => URL to modify tickets (with sign-on token for users with autogenerated account) * require p3 library
</pre>
{% endif %}
{% endblock %}
