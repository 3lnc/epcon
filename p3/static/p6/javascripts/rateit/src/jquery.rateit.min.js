!function(a){function b(a){var b=a.originalEvent.changedTouches,c=b[0],d="";switch(a.type){case"touchmove":d="mousemove";break;case"touchend":d="mouseup";break;default:return}var e=document.createEvent("MouseEvent");e.initMouseEvent(d,!0,!0,window,1,c.screenX,c.screenY,c.clientX,c.clientY,!1,!1,!1,!1,0,null),c.target.dispatchEvent(e),a.preventDefault()}a.fn.rateit=function(c,d){var e={},f="init";if(0==this.length)return this;var g=a.type(c);if("object"==g||void 0===c||null==c)e=a.extend({},a.fn.rateit.defaults,c);else{if("string"==g&&void 0===d)return this.data("rateit-"+c);"string"==g&&(f="setvalue")}return this.each(function(){var g=a(this),h=function(a,b){return g.data("rateit-"+a,b)};g.hasClass("rateit")||g.addClass("rateit");var i="rtl"!=g.css("direction");if("setvalue"==f){if(!h("init"))throw"Can't set value before init";if("readonly"!=c||h("readonly")||(g.find(".rateit-range").unbind(),h("wired",!1)),h("backingfld")){var j=a(h("backingfld"));"value"==c&&j.val(d),"min"==c&&j[0].min&&(j[0].min=d),"max"==c&&j[0].max&&(j[0].max=d),"step"==c&&j[0].step&&(j[0].step=d)}h(c,d)}if(!h("init")){if(h("min",h("min")||e.min),h("max",h("max")||e.max),h("step",h("step")||e.step),h("readonly",void 0!==h("readonly")?h("readonly"):e.readonly),h("resetable",void 0!==h("resetable")?h("resetable"):e.resetable),h("backingfld",h("backingfld")||e.backingfld),h("starwidth",h("starwidth")||e.starwidth),h("starheight",h("starheight")||e.starheight),h("value",h("value")||e.min),h("backingfld")){var j=a(h("backingfld"));h("value",j.hide().val()),"INPUT"==j[0].nodeName&&("range"!=j[0].type&&"text"!=j[0].type||(h("min",parseInt(j.attr("min"))||h("min")),h("max",parseInt(j.attr("max"))||h("max")),h("step",parseInt(j.attr("step"))||h("step")))),"SELECT"==j[0].nodeName&&j[0].options.length>1&&(h("min",Number(j[0].options[0].value)),h("max",Number(j[0].options[j[0].length-1].value)),h("step",Number(j[0].options[1].value)-Number(j[0].options[0].value)))}g.append('<div class="rateit-reset"></div><div class="rateit-range"><div class="rateit-selected" style="height:'+h("starheight")+'px"></div><div class="rateit-hover" style="height:'+h("starheight")+'px"></div></div>'),g.append('<div class="rateit-simplified"></div>');for(var k=g.find(".rateit-simplified"),l=[{text:"must see",score:10},{text:"want to see",score:7},{text:"maybe",score:3},{text:"not interested",score:0},{text:"not voted",score:-1}],m=0;m<l.length;m++){var n=l[m],o=a("<div />");o.data("score",n.score),o.text(n.text),h("value")==n.score&&o.addClass("selected"),k.append(o)}i||(g.find(".rateit-reset").css("float","right"),g.find(".rateit-selected").addClass("rateit-selected-rtl"),g.find(".rateit-hover").addClass("rateit-hover-rtl")),h("init",!0)}var p=g.find(".rateit-range");if(p.width(h("starwidth")*(h("max")-h("min"))).height(h("starheight")),h("value")){var q=(h("value")-h("min"))*h("starwidth");g.find(".rateit-selected").width(q)}var r=g.find(".rateit-reset"),s=function(b,c){var d=c.changedTouches?c.changedTouches[0].pageX:c.pageX,e=d-a(b).offset().left;return i||(e=p.width()-e),e>p.width()&&(e=p.width()),e<0&&(e=0),q=Math.ceil(e/h("starwidth")*(1/h("step")))};h("readonly")?r.hide():(h("resetable")?r.click(function(){h("value",h("min")),p.find(".rateit-hover").hide().width(0),p.find(".rateit-selected").width(0).show(),h("backingfld")&&a(h("backingfld")).val(h("min")),g.trigger("reset")}):r.hide(),h("wired")||(g.on("click",".rateit-simplified div:not(.selected)",function(b){g.find(".rateit-simplified div").removeClass("selected");var c=a(b.currentTarget);c.addClass("selected");var d=2*c.data("score");if(!(d<0)){var e=d*h("step")+h("min");h("value",e),p.find(".rateit-selected").width(d*h("starwidth")*h("step")).show(),g.trigger("hover",[null]).trigger("rated",[e])}}),p.bind("touchmove touchend",b),p.mousemove(function(a){var b=s(this,a),c=b*h("starwidth")*h("step"),d=p.find(".rateit-hover");d.data("width")!=c&&(p.find(".rateit-selected").hide(),d.width(c).show().data("width",c),g.trigger("hover",[b*h("step")+h("min")]))}),p.mouseleave(function(a){p.find(".rateit-hover").hide().width(0).data("width",""),g.trigger("hover",[null]),p.find(".rateit-selected").show()}),p.mouseup(function(b){var c=s(this,b),d=c*h("step")+h("min");h("value",d),h("backingfld")&&a(h("backingfld")).val(d),p.find(".rateit-hover").hide(),p.find(".rateit-selected").width(c*h("starwidth")*h("step")).show(),g.trigger("hover",[null]).trigger("rated",[d])}),h("wired",!0)),h("resetable")&&r.show())})},a.fn.rateit.defaults={min:0,max:5,step:.5,starwidth:16,starheight:16,readonly:!1,resetable:!0},a("div.rateit").rateit()}(jQuery);